generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserRole {
  ADMIN
  CUSTOMER
}

enum BillingCycle {
  MONTHLY
  YEARLY
}

enum PlanType {
  FREE
  PRO
  ENTERPRISE
}

enum CreditTrackingType {
  INCREASE
  DECREASE
}

enum SubscriptionStatus {
  ACTIVE
  CANCELLED
  EXPIRED
}

enum CreditSystemType {
  AI_CHAT
  IMAGE_GEN
}

model User {
  id        String   @id @default(ulid())
  email     String
  password  String
  salt      String
  firstName String
  lastName  String
  role      UserRole @default(CUSTOMER)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  deletedAt DateTime?
  isActive  Boolean  @default(true)
}

model Blog {
  id        String   @id @default(ulid())
  title     String
  content   String
  authorId  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  deletedAt DateTime?
  isActive  Boolean  @default(true)
}

model AuthSession {
  id          String   @id @default(ulid())
  userId      String
  roleAtLogin UserRole
  expiresAt   DateTime
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  deletedAt   DateTime?
  isActive    Boolean  @default(true)
}

model Plan {
  id          String       @id @default(ulid())
  name        String
  price       Decimal
  durationDay Int
  productId   String
  priceId     String
  isDisplay   Boolean
  isActive    Boolean
  isTrial     Boolean
  billingCycle BillingCycle
  planType    PlanType
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  deletedAt   DateTime?
}

model Subscription {
  id        String            @id @default(ulid())
  userId    String
  planId    String
  startDate DateTime
  endDate   DateTime
  status    SubscriptionStatus
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  deletedAt DateTime?
}

model CreditSystem {
  id        String   @id @default(ulid())
  name      String
  type      CreditSystemType
  description String
  amount    Decimal
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  deletedAt DateTime?
}

model CreditTracking {
  id               String             @id @default(ulid())
  name             String
  creditSystemType CreditTrackingType
  userId           String
  amount           Decimal
  type             CreditTrackingType
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
  deletedAt        DateTime?
}

model WebhookLog {
  id         String   @id @default(ulid())
  event      String
  payload    Json
  status     String
  receivedAt DateTime
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  deletedAt  DateTime?
}
