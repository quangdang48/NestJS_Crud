generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum BILLING_CYCLE {
  WEEKLY
  MONTHLY
  YEARLY
}

enum PLAN_TYPE {
  FREE
  PRO
  ENTERPRISE
}

enum CREDIT_TRACKING_TYPE {
  INCREASE
  DECREASE
}

enum SUBSCRIPTION_STATUS {
  ACTIVE
  CANCELLED
  EXPIRED
}

enum CREDIT_SYSTEM_TYPE {
  AI_CHAT
  IMAGE_GEN
}

enum USER_ROLE {
  CUSTOMER
  ADMIN
}

model User {
  id                 String         @id @default(ulid())
  stripeCustomerId   String?
  firstName          String
  lastName           String
  password           String
  email              String         
  salt               String
  role               USER_ROLE      @default(CUSTOMER)
  isActive           Boolean        @default(true)
  createdAt          DateTime       @default(now())
  updatedAt          DateTime       @updatedAt
  deletedAt          DateTime?
}

model AuthSession {
  id          String   @id @default(uuid())
  userId      String
  roleAtLogin USER_ROLE
  expiresAt   DateTime
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  deletedAt   DateTime?
}
model Blog {
  id        String   @id @default(ulid())
  title     String
  content   String
  authorId  String
  isActive           Boolean @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  deletedAt DateTime?
}

model Plan {
  id                 String         @id @default(ulid())
  name               String
  description        String?
  price              Float
  durationDays       Int
  stripeProductId    String
  stripePriceId      String
  isDisplay          Boolean
  isTrial            Boolean
  trialDays          Int?
  creditLimits       Json
  billingCycle       BILLING_CYCLE
  planType           PLAN_TYPE
  isActive           Boolean        @default(true)
  createdAt          DateTime       @default(now())
  updatedAt          DateTime       @updatedAt
  deletedAt          DateTime?
}

model Subscription {
  id                   String         @id @default(ulid())
  userId               String
  planId               String
  stripeSubscriptionId String
  startDate            DateTime
  endDate              DateTime
  status               SUBSCRIPTION_STATUS
  createdAt            DateTime       @default(now())
  updatedAt            DateTime       @updatedAt
  deletedAt            DateTime?
}

model CreditSystem {
  id           String            @id @default(ulid())
  name         String
  type         CREDIT_SYSTEM_TYPE
  description  String?
  defaultCredit Int
  isActive           Boolean        @default(true)
  createdAt    DateTime          @default(now())
  updatedAt    DateTime          @updatedAt
  deletedAt    DateTime?
}

model CreditTracking {
  id               String           @id @default(ulid())
  userId           String
  creditSystemType CREDIT_SYSTEM_TYPE
  amount           Float
  type             CREDIT_TRACKING_TYPE
  referenceId      String?
  description      String?
  isActive           Boolean        @default(true)
  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt
  deletedAt        DateTime?
}

model WebhookLog {
  id          String   @id @default(ulid())
  event       String
  payload     Json
  status      String
  receivedAt  DateTime
  isActive           Boolean        @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  deletedAt   DateTime?
}
